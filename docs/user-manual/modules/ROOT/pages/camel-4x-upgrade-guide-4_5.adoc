= Apache Camel 4.x Upgrade Guide

This document is for helping you upgrade your Apache Camel application
from Camel 4.x to 4.y. For example, if you are upgrading Camel 4.0 to 4.2, then you should follow the guides
from both 4.0 to 4.1 and 4.1 to 4.2.

== Upgrading Camel 4.4 to 4.5

=== camel-core

=== Intercept EIP

The `interceptFrom` and `interceptSentToEndpoint` EIPs is now storing the intercepted endpoint using key `Exchange.INTERCEPTED_ENDPOINT`
as exchange property instead of a header.

Before:

[source,java]
----
String uri = exchange.getIn().getHeader(Exchange.INTERCEPTED_ENDPOINT, String.class);
----

After:

[source,java]
----
String uri = exchange.getProperty(Exchange.INTERCEPTED_ENDPOINT, String.class);
----

=== camel-kamelet

Routes created by Kamelets are no longer registered as JMX MBeans to avoid cluttering up with unwanted MBeans, as a Kamelet
is intended to act like a Camel component, despite its implementation is Camel routes. This means that the number of routes
listed from JMX etc will no longer include Kamelet routes.


The old behaviour can be enabled by setting `registerRoutesCreateByKamelet=true`
on the `ManagementAgent` object. See more in the xref:jmx.adoc[JMX] documentation.
