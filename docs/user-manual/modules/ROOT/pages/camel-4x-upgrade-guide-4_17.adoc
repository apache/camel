= Apache Camel 4.x Upgrade Guide

This document is for helping you upgrade your Apache Camel application
from Camel 4.x to 4.y. For example, if you are upgrading Camel 4.0 to 4.2, then you should follow the guides
from both 4.0 to 4.1 and 4.1 to 4.2.

[NOTE]
====
https://github.com/apache/camel-upgrade-recipes/[The Camel Upgrade Recipes project] provides automated assistance for some common migration tasks.
Note that manual migration is still required.
See the xref:camel-upgrade-recipes-tool.adoc[documentation] page for details.
====

== Upgrading Camel 4.16 to 4.17

=== camel-jbang

The `camel-kamelets-catalog` JAR is now downloaded on-demand.
The version of the Kamelets is now specified via `--kamelets-version` option (or via maven dependencies).
The following option is no longer in use `-Dcamel-kamelets.version`.

Removed automatic fallback to download Kamelet YAML files from GitHub. Instead, kamelets are
now only loaded from embedded `camel-kamelets` JAR.

=== camel-infinispan

`camel-infinispan` has been upgraded to https://infinispan.org/blog/2025/11/10/infinispan-16-0[Infinispan 16].
Virtual threads are enabled by default for embedded mode with `camel-infinispan-embedded`.

If you choose to listen for cache events on the `infinispan-embedded` consumer, it is possible that events are not processed in a predicatable order.
Disabling virtual threads by setting system property `org.infinispan.threads.virtual` to `false` leads to more predicatable event order processing.

=== Component deprecation

The `camel-stomp` component is deprecated.
