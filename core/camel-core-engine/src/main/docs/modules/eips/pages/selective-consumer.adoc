= Selective Consumer

Camel supports the
https://www.enterpriseintegrationpatterns.com/patterns/messaging/MessageSelector.html[Selective Consumer]
from the xref:enterprise-integration-patterns.adoc[EIP patterns] book.

How can a message consumer select which messages it wishes to receive?

image::eip/MessageSelectorSolution.gif[image]

Make the consumer a Selective Consumer, one that filteres the messages delivered by its channel so that it only receives the ones that match its criteria.

== Using Selecting Consumer

In Camel the Selective Consumer EIP is implemented in two ways:

- Using xref:components::index.adoc[Components] which supports message selecting.
- Using the xref:filter-eip.adoc[Filter] EIP as message selecting.

=== Selective Consumer using Components

The first solution is to provide a Message Selector to the underlying URIs when creating your consumer.
For example when using xref:components::jms-component.adoc[JMS] you can specify a
JMS selector parameter so that the message broker will only deliver messages matching your criteria.

[source,java]
----
from("jms:queue:hello?selector=color='red'")
  .to("bean:red");
----

And in XML:

[source,xml]
----
<route>
  <from uri="jms:queue:hello?selector=color='red'"/>
  <to uri="bean:red"/>
</route>
----

=== Selective Consumer using Filter EIP

The other approach is to use a xref:filter-eip.adoc[Message Filter] which is applied;
if the filter matches the message your "consumer" is invoked as shown in the following example:

[source,java]
----
from("seda:colors")
    .filter(header("color").isEqualTo("red"))
        .to("bean:red")
----

And in XML

[source,xml]
----
<route>
    <from uri="seda:colors"/>
    <filter>
        <simple>${header.color} == 'red'</xpath>
        <to uri="bean:red"/>
    </filter>
</route>
----

