= LangChain4j Embeddings Component
:doctitle: LangChain4j Embeddings
:shortname: langchain4j-embeddings
:artifactid: camel-langchain4j-embeddings
:description: LangChain4j Embeddings
:since: 4.5
:supportlevel: Stable
:tabs-sync-option:
:component-header: Only producer is supported
//Manually maintained attributes
:group: AI
:camel-spring-boot-name: langchain4j-embeddings

*Since Camel {since}*

*{component-header}*

The LangChain4j embeddings component provides support for compute embeddings using https://docs.langchain4j.dev/[LangChain4j] embeddings.

== URI format

----
langchain4j-embeddings:embeddingId[?options]
----

Where *embeddingId* can be any string to uniquely identify the endpoint


// component options: START
include::partial$component-configure-options.adoc[]
include::partial$component-endpoint-options.adoc[]
include::partial$component-endpoint-headers.adoc[]
// component options: END

include::spring-boot:partial$starter.adoc[]

== Usage

=== Using Embedding Models

The Camel LangChain4j embeddings component provides support for generating embeddings using various embedding models supported by https://docs.langchain4j.dev/[LangChain4j].

==== Integrating with specific Embedding Model

===== Using LangChain4j Spring Boot Starters (Recommended for Spring Boot)

When using Camel with Spring Boot, you can leverage LangChain4j's Spring Boot starters for automatic configuration of embedding models.

Add the dependency for LangChain4j OpenAI Spring Boot starter:

.pom.xml
[source,xml]
----
<dependency>
    <groupId>dev.langchain4j</groupId>
    <artifactId>langchain4j-open-ai-spring-boot-starter</artifactId>
    <version>1.10.0</version>
    <!-- use the same version as your LangChain4j version -->
</dependency>
----

Configure the OpenAI Embedding Model in `application.properties` or `application.yml`:

.application.properties
[source,properties]
----
langchain4j.open-ai.embedding-model.api-key=${OPENAI_API_KEY}
langchain4j.open-ai.embedding-model.model-name=text-embedding-ada-002
----

.application.yml
[source,yaml]
----
langchain4j:
  open-ai:
    embedding-model:
      api-key: ${OPENAI_API_KEY}
      model-name: text-embedding-ada-002
----

The `EmbeddingModel` bean will be automatically configured and available in the Spring context. Use it in your Camel routes:

[tabs]
====
Java::
+
[source,java]
----
from("direct:embeddings")
    .to("langchain4j-embeddings:test?embeddingModel=#embeddingModel");
----

YAML::
+
[source,yaml]
----
- route:
    from:
      uri: "direct:embeddings"
    steps:
      - to:
          uri: "langchain4j-embeddings:test"
          parameters:
            embeddingModel: "#embeddingModel"
----

XML::
+
[source,xml]
----
<route>
  <from uri="direct:embeddings"/>
  <to uri="langchain4j-embeddings:test?embeddingModel=#embeddingModel"/>
</route>
----
====

[NOTE]
====
LangChain4j Spring Boot starters provide auto-configuration for various embedding model providers including:

* `langchain4j-open-ai-spring-boot-starter` - OpenAI embeddings
* `langchain4j-azure-open-ai-spring-boot-starter` - Azure OpenAI embeddings
* `langchain4j-ollama-spring-boot-starter` - Ollama embeddings
* `langchain4j-hugging-face-spring-boot-starter` - Hugging Face embeddings
* `langchain4j-vertex-ai-spring-boot-starter` - Google Vertex AI embeddings

For a complete list of available starters and their configuration options, refer to the https://docs.langchain4j.dev/tutorials/spring-boot-integration[LangChain4j Spring Boot Integration documentation].
====

===== Manual Configuration (Alternative)

Alternatively, you can manually initialize the Embedding Model and add it to the Camel Registry:

Add the dependency for LangChain4j OpenAI support:

.pom.xml
[source,xml]
----
<dependency>
    <groupId>dev.langchain4j</groupId>
    <artifactId>langchain4j-open-ai</artifactId>
    <version>1.10.0</version>
    <!-- use the same version as your LangChain4j version -->
</dependency>
----

Initialize the OpenAI Embedding Model:

[source,java]
----
EmbeddingModel embeddingModel = OpenAiEmbeddingModel.builder()
    .apiKey(openApiKey)
    .modelName("text-embedding-ada-002")
    .build();
context.getRegistry().bind("myEmbeddingModel", embeddingModel);
----

Use the model in the Camel LangChain4j Embeddings Producer:

[tabs]
====
Java::
+
[source,java]
----
from("direct:embeddings")
    .to("langchain4j-embeddings:test?embeddingModel=#myEmbeddingModel");
----

YAML::
+
[source,yaml]
----
- route:
    from:
      uri: "direct:embeddings"
    steps:
      - to:
          uri: "langchain4j-embeddings:test"
          parameters:
            embeddingModel: "#myEmbeddingModel"
----
====

=== Integration with Vector Stores

The LangChain4j Embeddings component works seamlessly with vector databases for RAG (Retrieval-Augmented Generation) workflows.

==== Using with Qdrant

This example shows how to embed text and store it in Qdrant vector database:

[tabs]
====
Java::
+
[source,java]
----
from("direct:store")
    .to("langchain4j-embeddings:embed")
    .setHeader(Qdrant.Headers.ACTION).constant(QdrantAction.UPSERT)
    .setHeader(Qdrant.Headers.POINT_ID).constant(1)
    .transformDataType(new DataType("qdrant:embeddings"))
    .to("qdrant:myCollection");
----

YAML::
+
[source,yaml]
----
- route:
    from:
      uri: "direct:store"
    steps:
      - to: "langchain4j-embeddings:embed"
      - setHeader:
          name: CamelQdrantAction
          constant: UPSERT
      - setHeader:
          name: CamelQdrantPointId
          constant: 1
      - transform:
          dataType: "qdrant:embeddings"
      - to: "qdrant:myCollection"
----
====

==== Similarity Search for RAG

Retrieve relevant content using similarity search:

[tabs]
====
Java::
+
[source,java]
----
from("direct:search")
    .to("langchain4j-embeddings:embed")
    .transformDataType(new DataType("qdrant:embeddings"))
    .setHeader(Qdrant.Headers.ACTION, constant(QdrantAction.SIMILARITY_SEARCH))
    .setHeader(Qdrant.Headers.INCLUDE_PAYLOAD, constant(true))
    .to("qdrant:myCollection")
    .transformDataType(new DataType("qdrant:rag"));
----

YAML::
+
[source,yaml]
----
- route:
    from:
      uri: "direct:search"
    steps:
      - to: "langchain4j-embeddings:embed"
      - transform:
          dataType: "qdrant:embeddings"
      - setHeader:
          name: CamelQdrantAction
          constant: SIMILARITY_SEARCH
      - setHeader:
          name: CamelQdrantIncludePayload
          constant: true
      - to: "qdrant:myCollection"
      - transform:
          dataType: "qdrant:rag"
----
====

==== Using with LangChain4j Embedding Store Component

For a simpler integration, use the `langchain4j-embeddingstore` component which provides a unified interface:

[tabs]
====
Java::
+
[source,java]
----
from("direct:store")
    .to("langchain4j-embeddings:embed")
    .to("langchain4j-embeddingstore:myStore?action=ADD");

from("direct:search")
    .to("langchain4j-embeddings:embed")
    .to("langchain4j-embeddingstore:myStore?action=SEARCH&maxResults=5&returnTextContent=true");
----

YAML::
+
[source,yaml]
----
- route:
    from:
      uri: "direct:store"
    steps:
      - to: "langchain4j-embeddings:embed"
      - to: "langchain4j-embeddingstore:myStore?action=ADD"

- route:
    from:
      uri: "direct:search"
    steps:
      - to: "langchain4j-embeddings:embed"
      - to: "langchain4j-embeddingstore:myStore?action=SEARCH&maxResults=5&returnTextContent=true"
----
====
